{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "DecisionEvent",
  "type": "object",
  "required": ["event_type", "event_id", "user_id", "evaluated_at", "date_jst", "decision", "engine"],
  "properties": {
    "event_type": { "type": "string", "const": "decision_evaluated" },
    "event_id": { "type": "string" },
    "user_id": { "type": "string" },
    "evaluated_at": { "type": "string" },
    "date_jst": { "type": "string" },
    "decision": {
      "type": "object",
      "required": ["type", "tip_id", "severity", "policy_id", "reason", "recommendation"],
      "properties": {
        "type": { "type": "string", "enum": ["show", "suppress", "snooze"] },
        "tip_id": { "type": "string" },
        "severity": { "type": "string", "enum": ["HIGH", "MEDIUM", "LOW"] },
        "policy_id": { "type": "string" },
        "reason": { "type": "string" },
        "review_at": { "type": "string" },
        "recommendation": { "type": "boolean", "const": true }
      }
    },
    "engine": {
      "type": "object",
      "required": ["version", "policy_set_hash", "source"],
      "properties": {
        "version": { "type": "string" },
        "policy_set_hash": { "type": "string" },
        "source": { "type": "string" }
      }
    }
  }
}
